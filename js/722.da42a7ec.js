"use strict";(self["webpackChunksl_device_vue"]=self["webpackChunksl_device_vue"]||[]).push([[722],{9427:function(t,e,n){n.d(e,{A:function(){return u}});var a=function(){var t=this,e=t._self._c;return e("div",[e("van-card",{staticClass:"card-custom",scopedSlots:t._u([{key:"title",fn:function(){return[e("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[e("van-tag",{attrs:{mark:"",type:"primary",size:"medium"}},[t._v("保洁")]),t._v(" "+t._s(t.item.name))],1)]},proxy:!0},{key:"price",fn:function(){return[e("van-tag",{attrs:{type:t.statusChange(t.item.state)}},[t._v(t._s(t._f("stateFilter")(t.item.state)))])]},proxy:!0},{key:"desc",fn:function(){return[e("p",[t._v("从"+t._s(t.item.plan_start)+"开始")])]},proxy:!0},{key:"footer",fn:function(){return[e("van-button",{staticStyle:{width:"80px"},attrs:{round:"",type:"primary",size:"small",icon:"eye-o"},on:{click:function(e){return t.toSign(t.item)}}},[t._v("查看")])]},proxy:!0}])})],1)},i=[],r={name:"CleanCard",filters:{stateFilter(t){const e={0:"未开始",1:"进行中",10:"已完成",20:"已过期"};return e[t]}},props:{item:{type:Object,require:!0,default(){return{}}}},methods:{statusChange(t){const e={0:"default",1:"success",10:"primary",20:"danger"};return e[t]},async toSign(t){this.$utils.routerUrl("/clean/ticket-info",{ticket_id:t.id})}}},s=r,o=n(845),c=(0,o.A)(s,a,i,!1,null,"538e5153",null),u=c.exports},7722:function(t,e,n){n.r(e),n.d(e,{default:function(){return p}});var a=function(){var t=this,e=t._self._c;return e("div",[e("van-sticky",[e("van-row",{staticStyle:{padding:"10px","text-align":"center"}},[e("van-col",{attrs:{span:"8"}},[e("van-button",{attrs:{icon:"clock",type:t.buttonToday,round:"",size:"small"},on:{click:t.clickToday}},[t._v("今天 "+t._s(t.today))])],1),e("van-col",{attrs:{span:"8"}},[e("van-button",{attrs:{icon:"clock",type:t.buttonTomorrow,round:"",size:"small"},on:{click:t.clickTomorrow}},[t._v("明天 "+t._s(t.tomorrow))])],1),e("van-col",{attrs:{span:"8"}},[e("van-button",{attrs:{icon:"clock",type:t.buttonRecently,round:"",size:"small"},on:{click:t.clickRecently}},[t._v("最近 "+t._s(t.recently))])],1)],1)],1),e("div",[e("van-pull-refresh",{style:`height: ${t.refreshHeight}px;overflow:auto;`,on:{refresh:function(e){return t.onRefresh()}},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[0===t.list.length?e("van-empty",{attrs:{image:"search",description:"暂无数据"}}):t._l(t.list,(function(n,a){return e("div",{key:a},["clean"===n.data_type?e("clean-card",{attrs:{item:n}}):t._e(),"qc"===n.data_type?e("qc-card",{attrs:{item:n}}):t._e(),"transport"===n.data_type?e("transport-card",{attrs:{item:n},on:{refreshList:t.getDataList}}):t._e(),"task"===n.data_type?e("task-card",{attrs:{item:n}}):t._e()],1)})),e("van-calendar",{attrs:{"show-confirm":!1,"min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.onConfirm},model:{value:t.showCalendar,callback:function(e){t.showCalendar=e},expression:"showCalendar"}})],2)],1)],1)},i=[],r=n(4277),s=n(9427),o=n(2982),c=n(5791),u={name:"TicketIndex",components:{TaskCard:c.A,TransportCard:o.A,CleanCard:s.A,QcCard:r.A},filters:{statusFilter(t){const e={0:"未开始",1:"进行中",10:"已完成",20:"已过期"};return e[t]},dataTypeFilter(t){const e={clean:"保洁",qc:"巡更",transport:"运送",task:"任务"};return e[t]}},data(){return{today:this.$date().format("MM-DD"),tomorrow:this.$date().add(1,"days").format("MM-DD"),recently:"",list:[],buttonToday:"default",buttonTomorrow:"default",buttonRecently:"default",showCalendar:!1,minDate:this.$date().subtract(1,"month").toDate(),maxDate:this.$date().add(1,"month").toDate(),refreshing:!1,refreshHeight:window.innerHeight-52,ticketDate:this.$date().format("YYYY-MM-DD")}},mounted(){this.buttonToday="info",this.getDataList()},methods:{statusChange(t){const e={0:"default",1:"success",10:"primary",20:"danger"};return e[t]},async getDataList(){const t=await this.$post("/ticket/list",{ticket_date:this.ticketDate});t&&t.length>0?this.list=t:this.list=[]},clickToday(){this.buttonToday="info",this.buttonTomorrow="default",this.buttonRecently="default",this.ticketDate=this.$date().format("YYYY-MM-DD"),this.getDataList()},clickTomorrow(){this.buttonToday="default",this.buttonTomorrow="info",this.buttonRecently="default",this.ticketDate=this.$date().add(1,"days").format("YYYY-MM-DD"),this.getDataList()},clickRecently(){this.buttonToday="default",this.buttonTomorrow="default",this.buttonRecently="info",this.showCalendar=!0},onConfirm(t){this.showCalendar=!1,this.recently=this.$date(t).format("MM-DD"),this.ticketDate=this.$date(t).format("YYYY-MM-DD"),this.getDataList()},onRefresh(){setTimeout((()=>{this.refreshing=!1,this.getDataList()}),1e3)}}},l=u,d=n(845),m=(0,d.A)(l,a,i,!1,null,"55f5cec4",null),p=m.exports},4277:function(t,e,n){n.d(e,{A:function(){return u}});var a=function(){var t=this,e=t._self._c;return e("div",[e("van-card",{staticClass:"card-custom",scopedSlots:t._u([{key:"title",fn:function(){return[e("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[e("van-tag",{attrs:{mark:"",type:"primary",size:"medium"}},[t._v("巡更")]),t._v(" "+t._s(t.item.name))],1)]},proxy:!0},{key:"price",fn:function(){return[e("van-tag",{attrs:{type:t.statusChange(t.item.state)}},[t._v(t._s(t._f("stateFilter")(t.item.state)))])]},proxy:!0},{key:"desc",fn:function(){return[e("p",[t._v("从"+t._s(t.item.plan_start)+"开始")])]},proxy:!0},{key:"footer",fn:function(){return[10===t.item.state?e("van-button",{staticStyle:{width:"80px"},attrs:{round:"",type:"primary",size:"small",icon:"eye-o"},on:{click:function(e){return t.toSign(t.item)}}},[t._v("查看")]):t._e(),1!==t.item.plan_type||0!==t.item.state&&1!==t.item.state?t._e():e("van-button",{staticStyle:{width:"80px"},attrs:{round:"",type:"primary",size:"small",icon:"scan"},on:{click:function(e){return t.toSign(t.item)}}},[t._v("签到")]),2!==t.item.plan_type||0!==t.item.state&&1!==t.item.state?t._e():e("van-button",{staticStyle:{width:"80px"},attrs:{round:"",type:"primary",size:"small",icon:"edit"},on:{click:function(e){return t.toSign(t.item)}}},[t._v("签字")])]},proxy:!0}])})],1)},i=[],r={name:"QcCard",filters:{stateFilter(t){const e={0:"未开始",1:"进行中",10:"已完成",20:"已过期"};return e[t]}},props:{item:{type:Object,require:!0,default(){return{}}}},methods:{statusChange(t){const e={0:"default",1:"success",10:"primary",20:"danger"};return e[t]},toSign(t){this.$utils.routerUrl("/qc/step-list",{plan_type:t.plan_type,ticket_id:t.id,report_flag:t.report_flag,scan_flag:t.scan_flag,sign_mode:t.sign_mode})}}},s=r,o=n(845),c=(0,o.A)(s,a,i,!1,null,null,null),u=c.exports},5791:function(t,e,n){n.d(e,{A:function(){return u}});var a=function(){var t=this,e=t._self._c;return e("div",[e("van-card",{staticClass:"card-custom",scopedSlots:t._u([{key:"title",fn:function(){return[e("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[e("van-tag",{attrs:{mark:"",type:"primary",size:"medium"}},[t._v("任务")]),t._v(" "+t._s(t.item.name))],1)]},proxy:!0},{key:"price",fn:function(){return[e("van-tag",{attrs:{type:t.statusChange(t.item.state)}},[t._v(t._s(t._f("statusFilter")(t.item.state)))])]},proxy:!0},{key:"desc",fn:function(){return[e("p",[t._v(t._s(t.item.note))])]},proxy:!0},{key:"footer",fn:function(){return[10===t.item.state?e("van-button",{staticStyle:{width:"80px"},attrs:{size:"small",round:"",type:"primary",icon:"eye-o"},on:{click:function(e){return t.detailTask(t.item)}}},[t._v("查看")]):t._e(),10!==t.item.state&&20!==t.item.state?e("van-button",{staticStyle:{width:"80px"},attrs:{size:"small",round:"",type:"primary",icon:"records-o"},on:{click:function(e){return t.dispose(t.item)}}},[t._v("处理")]):t._e()]},proxy:!0}])})],1)},i=[],r={name:"TaskCard",filters:{statusFilter(t){const e={0:"未开始",1:"进行中",10:"已完成",20:"已过期"};return e[t]}},props:{item:{type:Object,require:!0,default(){return{}}}},data(){return{}},mounted(){},methods:{statusChange(t){const e={0:"default",1:"success",10:"primary",20:"danger"};return e[t]},detailTask(t){this.$utils.routerUrl("/ticket/task-detail",{id:t.id,state:t.state})},dispose(t){this.$utils.routerUrl("/ticket/task-dispose",{templateId:t.template_id,id:t.id})}}},s=r,o=n(845),c=(0,o.A)(s,a,i,!1,null,"7e09ea39",null),u=c.exports},2982:function(t,e,n){n.d(e,{A:function(){return u}});var a=function(){var t=this,e=t._self._c;return e("div",[e("van-card",{staticClass:"card-custom",scopedSlots:t._u([{key:"title",fn:function(){return[e("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[e("van-tag",{attrs:{mark:"",type:"primary",size:"medium"}},[t._v("运送")]),t._v(" "+t._s(t.item.item_name))],1)]},proxy:!0},{key:"price",fn:function(){return[e("van-tag",{attrs:{type:t.statusChange(t.item.state)}},[t._v(t._s(t._f("stateFilter")(t.item.state)))])]},proxy:!0},{key:"desc",fn:function(){return[e("p",[t._v("运送路径："+t._s(t.item.name))]),e("p",[t._v("下单时间："+t._s(t.item.create_time))]),2===t.item.state?e("p",[t._v("取件时间："+t._s(t.item.get_time))]):t._e(),10===t.item.state?e("p",[t._v("完成时间："+t._s(t.item.complete_time))]):t._e()]},proxy:!0},{key:"footer",fn:function(){return[e("van-button",{staticStyle:{width:"100px"},attrs:{round:"",type:"primary",size:"small",icon:"eye-o"},on:{click:function(e){return t.toSign(t.item)}}},[t._v("查看")]),1===t.item.state?e("van-button",{staticStyle:{width:"100px"},attrs:{round:"",type:"primary",size:"small",icon:"add-o"},on:{click:function(e){return t.toPickUp(t.item)}}},[t._v("取件")]):t._e(),2===t.item.state?e("van-button",{staticStyle:{width:"100px"},attrs:{round:"",type:"primary",size:"small",icon:"checked"},on:{click:function(e){return t.toComplete(t.item)}}},[t._v("确认签收")]):t._e()]},proxy:!0}])})],1)},i=[],r={name:"TransportCard",filters:{stateFilter(t){const e={0:"未开始",1:"已派工",2:"运送中",10:"已完成",20:"已过期"};return e[t]}},props:{item:{type:Object,require:!0,default(){return{}}}},methods:{statusChange(t){const e={0:"default",1:"success",10:"primary",20:"danger"};return e[t]},toSign(t){this.$utils.routerUrl("/transport/info",{ticket_id:t.id})},async toPickUp(t){const e=await this.$dialog.confirm({title:"标题",message:"是否确认取件？"}).catch((()=>{}));e&&(await this.$http.post("/transport-ticket/pick-up",{ticket_id:t.id}),await this.$toast.success("操作成功！"),this.$emit("refreshList"))},toComplete(t){this.$utils.routerUrl("/transport/sign",{ticket_id:t.id})}}},s=r,o=n(845),c=(0,o.A)(s,a,i,!1,null,null,null),u=c.exports}}]);
//# sourceMappingURL=722.da42a7ec.js.map